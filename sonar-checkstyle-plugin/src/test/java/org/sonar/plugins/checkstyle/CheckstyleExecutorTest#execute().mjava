  @Test
  public void execute() throws Exception {
    CheckstyleConfiguration conf = mockConf();
    CheckstyleAuditListener listener = mockListener();
    CheckstyleExecutor executor = new CheckstyleExecutor(conf, listener, getClass().getClassLoader());
    executor.execute();

    verify(listener, times(1)).auditStarted(any(AuditEvent.class));
    verify(listener, times(1)).auditFinished(any(AuditEvent.class));

    InOrder inOrder = Mockito.inOrder(listener);
    ArgumentCaptor<AuditEvent> captor = ArgumentCaptor.forClass(AuditEvent.class);
    inOrder.verify(listener).fileStarted(captor.capture());
    assertThat(captor.getValue().getFileName()).matches(".*Hello.java");
    inOrder.verify(listener).fileFinished(captor.capture());
    assertThat(captor.getValue().getFileName()).matches(".*Hello.java");
    inOrder.verify(listener).fileStarted(captor.capture());
    assertThat(captor.getValue().getFileName()).matches(".*World.java");
    inOrder.verify(listener).fileFinished(captor.capture());
    assertThat(captor.getValue().getFileName()).matches(".*World.java");
    verify(listener, atLeast(1)).addError(captor.capture());
    AuditEvent event = captor.getValue();
    assertThat(event.getFileName()).matches(".*Hello.java");
    assertThat(event.getSourceName()).matches("com.puppycrawl.tools.checkstyle.checks.coding.EmptyStatementCheck");
  }

