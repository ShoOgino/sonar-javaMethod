  private JsonArray constraints() {
    Stream.Builder<JsonObject> constraints = Stream.builder();
    ps.constraints.forEach((sv, constraint) -> {
      JsonObject jsonConstraint = Json.createObjectBuilder()
        .add("sv", sv.toString())
        .add("constraints", constraintsAsJsonArray(constraint))
        .build();
      constraints.add(jsonConstraint);
    });
    return JsonHelper.toArraySortedByField(constraints.build(), "sv");
  }

