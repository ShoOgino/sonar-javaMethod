  @Test
  public void should_load_profile_in_sonar_lint_context() {
    ProfileDefinition sonarWay = new JavaSonarWayProfile(ruleFinder(true));
    ValidationMessages validation = ValidationMessages.create();
    RulesProfile profile = sonarWay.createProfile(validation);
    assertThat(profile.getActiveRules()).extracting("repositoryKey").containsOnly(CheckList.REPOSITORY_KEY);
    assertThat(profile.getActiveRulesByRepository("common-java")).isEmpty();
    assertThat(profile.getActiveRulesByRepository(CheckList.REPOSITORY_KEY).size()).isGreaterThanOrEqualTo(268);
    assertThat(profile.getName()).isEqualTo("Sonar way");

    assertThat(validation.hasErrors()).isFalse();
    // Check that we use severity from the read rule and not default one.
    assertThat(profile.getActiveRulesByRepository(CheckList.REPOSITORY_KEY).get(0).getSeverity()).isSameAs(RulePriority.MINOR);

  }

