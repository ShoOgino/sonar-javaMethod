    void restoreLocationAfter(Runnable action) {
      boolean wasAtEnd = isAtEnd;
      boolean wasAtBeginning = isAtBeginning;
      action.run();
      isAtEnd = wasAtEnd;
      isAtBeginning = wasAtBeginning;
    }

