    @Override
    public void visitCharacterClassUnion(CharacterClassUnionTree tree) {
      List<RegexSyntaxElement> duplicates = new ArrayList<>();
      SimplifiedRegexCharacterClass characterClass = new SimplifiedRegexCharacterClass();
      for (CharacterClassElementTree element : tree.getCharacterClasses()) {
        List<RegexSyntaxElement> intersections = new SimplifiedRegexCharacterClass(element).findIntersections(characterClass);

        if (!intersections.isEmpty()) {
          for (RegexSyntaxElement intersection : intersections) {
            if (!duplicates.contains(intersection)) {
              // The element the current element is intersecting with should be included as well.
              duplicates.add(intersection);
            }
          }
          duplicates.add(element);
        }
        characterClass.add(element);
      }
      if (!duplicates.isEmpty()) {
        List<RegexIssueLocation> secondaries = duplicates.stream()
          .skip(1)
          .map(duplicate -> new RegexIssueLocation(duplicate, "Additional duplicate"))
          .collect(Collectors.toList());
        reportIssue(duplicates.get(0), MESSAGE, null, secondaries);
      }
      super.visitCharacterClassUnion(tree);
    }

