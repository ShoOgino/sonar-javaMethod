  private void ensureGroupsComputed() {
    if (!areGroupsComputed) {
      computeGroups();
      areGroupsComputed = true;
    }
  }

