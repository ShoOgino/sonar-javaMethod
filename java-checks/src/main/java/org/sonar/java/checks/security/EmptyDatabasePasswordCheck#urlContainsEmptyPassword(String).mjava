  private static boolean urlContainsEmptyPassword(String url) {
    Matcher matcher = URL_PATTERN.matcher(url);
    if (matcher.matches()) {
      String password = matcher.group("password");
      String password2 = matcher.group("password2");
      return (password != null && password.trim().isEmpty()) || (password2 != null && password2.trim().isEmpty());
    }
    return EMPTY_PASSWORD_PATTERN.matcher(url).matches() || !url.contains("password=");
  }

