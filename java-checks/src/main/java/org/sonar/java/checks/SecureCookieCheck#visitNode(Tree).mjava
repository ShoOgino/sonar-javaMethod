  @Override
  public void visitNode(Tree tree) {
    if (hasSemantic()) {
      if (tree.is(Tree.Kind.VARIABLE)) {
        VariableTree variableTree = (VariableTree) tree;
        Type type = variableTree.type().symbolType();
        if (type.is("javax.servlet.http.Cookie") && isConstructorInitialized(variableTree)) {
          Symbol variableSymbol = variableTree.symbol();
          //Ignore field variables
          if (variableSymbol.owner().isMethodSymbol()) {
            unsecuredCookies.add(variableSymbol);
          }
        }
      } else if (tree.is(Tree.Kind.METHOD_INVOCATION)) {
        MethodInvocationTree mit = (MethodInvocationTree) tree;
        if (isSetSecureCall(mit) && mit.methodSelect().is(Tree.Kind.MEMBER_SELECT)) {
          MemberSelectExpressionTree mse = (MemberSelectExpressionTree) mit.methodSelect();
          if (mse.expression().is(Tree.Kind.IDENTIFIER)) {
            Symbol reference = getSemanticModel().getReference((IdentifierTree) mse.expression());
            unsecuredCookies.remove(reference);
          }
        }
      }
    }
  }

