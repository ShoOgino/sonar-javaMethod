    @Override
    public void visitAtomicGroup(AtomicGroupTree tree) {
      // Nested repetitions are unproblematic if the inner repetition is inside an atomic group, but not if both
      // repetitions are inside the atomic group. So we enter the group with a clean slate and then restore the
      // state afterwards.
      boolean oldIsInsideRepetition = isInsideRepetition;
      isInsideRepetition = false;
      super.visitAtomicGroup(tree);
      isInsideRepetition = oldIsInsideRepetition;
    }

