  private int getMatchingToIndex(PatternMatcherResult patternMatcherResult) {
    int lastMatchedTokenIndex = 0;

    for (PatternMatcherResult currentPatternMatcherResult = patternMatcherResult; currentPatternMatcherResult != null; currentPatternMatcherResult = currentPatternMatcherResult
        .getNextPatternMatcherResult()) {
      lastMatchedTokenIndex += currentPatternMatcherResult.getMatchingToIndex();
    }

    return lastMatchedTokenIndex;
  }

