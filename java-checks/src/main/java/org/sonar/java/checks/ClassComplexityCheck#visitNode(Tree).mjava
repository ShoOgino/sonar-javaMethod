  @Override
  public void visitNode(Tree tree) {
    List<Tree> complexity = context.getComplexityNodes(tree);
    int size = complexity.size();
    if (size > max) {
      List<JavaFileScannerContext.Location> flow = new ArrayList<>();
      for (Tree element : complexity) {
        flow.add(new JavaFileScannerContext.Location("Complexity + 1", element));
      }
      ClassTree classTree = (ClassTree) tree;
      Tree report = classTree.simpleName() == null ? classTree.openBraceToken() : classTree.simpleName();
      reportIssue(report, "The Cyclomatic Complexity of this class is " + size + " which is greater than " + max + " authorized.", flow, size - max);
    }
  }

