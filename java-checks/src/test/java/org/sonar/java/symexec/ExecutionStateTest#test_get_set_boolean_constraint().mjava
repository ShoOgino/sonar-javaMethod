  @Test
  public void test_get_set_boolean_constraint() {
    ExecutionState state = new ExecutionState();

    Symbol.VariableSymbol fieldSymbol = mock(Symbol.VariableSymbol.class);
    when(fieldSymbol.isVariableSymbol()).thenReturn(true);
    SymbolicValue.SymbolicVariableValue fieldValue = new SymbolicValue.SymbolicVariableValue(fieldSymbol);

    // constraint for a variable is unknown by default and can be set.
    assertThat(state.getBooleanConstraint(fieldValue)).isSameAs(UNKNOWN);
    state.setBooleanConstraint(fieldValue, FALSE);
    assertThat(state.getBooleanConstraint(fieldValue)).isSameAs(FALSE);

    // constraint for a variable must be queried in the parent state.
    ExecutionState nestedState = new ExecutionState(state);
    assertThat(nestedState.getBooleanConstraint(fieldValue)).isSameAs(FALSE);

    // constraint for a variable must shadow constraint from the parent state.
    nestedState.setBooleanConstraint(fieldValue, TRUE);
    assertThat(state.getBooleanConstraint(fieldValue)).isSameAs(FALSE);
    assertThat(nestedState.getBooleanConstraint(fieldValue)).isSameAs(TRUE);

    // state.setBooleanConstraint must return state
    assertThat(state.setBooleanConstraint(fieldValue, UNKNOWN)).isSameAs(state);
  }

