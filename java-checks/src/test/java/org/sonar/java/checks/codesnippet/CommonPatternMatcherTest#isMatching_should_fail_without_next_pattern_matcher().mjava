  @Test
  public void isMatching_should_fail_without_next_pattern_matcher() {
    Token token1 = mockToken("token1");
    Token token2 = mockToken("token2");
    Token token3 = mockToken("token3");

    List<Token> tokensToMatch = Lists.newArrayList(token1, token3);

    Comparator<Token> comparator = mock(Comparator.class);
    when(comparator.compare(token1, token1)).thenReturn(0);
    when(comparator.compare(token3, token2)).thenReturn(-1);

    CommonPatternMatcher patternMatcher = new CommonPatternMatcher(tokensToMatch, comparator);

    assertThat(patternMatcher.match(Lists.newArrayList(token1, token2, token3)).isMatching()).isEqualTo(false);

    verify(comparator).compare(token1, token1);
    verify(comparator).compare(token3, token2);
    verify(comparator, never()).compare(token2, token2);
    verify(comparator, never()).compare(token3, token3);
  }

