  @Test
  public void parse() {
    Parser<MyGrammar> p = getParser();
    MyGrammar g = p.getGrammar();
    List<Token> tokens = getLexer().lex("foo");
    tokens = tokens.subList(0, tokens.size() - 1); // Remove EOF

    PrefixParser partialParser = new PrefixParser(p);
    p.setRootRule(g.foo);
    assertThat(partialParser.parse(tokens)).isEqualTo(PrefixParser.PrefixParseResult.MISMATCH);
    p.setRootRule(g.bar);
    assertThat(partialParser.parse(tokens)).isEqualTo(PrefixParser.PrefixParseResult.FULL_MATCH);
    p.setRootRule(g.baz);
    assertThat(partialParser.parse(tokens)).isEqualTo(PrefixParser.PrefixParseResult.PARTIAL_MATCH);

    tokens = getLexer().lex("foo bar");
    tokens = tokens.subList(0, tokens.size() - 1); // Remove EOF

    p.setRootRule(g.bar);
    assertThat(partialParser.parse(tokens)).isEqualTo(PrefixParser.PrefixParseResult.MISMATCH);
    p.setRootRule(g.baz);
    assertThat(partialParser.parse(tokens)).isEqualTo(PrefixParser.PrefixParseResult.FULL_MATCH);
  }

