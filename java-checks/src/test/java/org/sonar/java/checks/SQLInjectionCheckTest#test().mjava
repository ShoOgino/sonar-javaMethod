  @Test
  public void test() {
    SourceFile file = JavaAstScanner.scanSingleFile(new File("src/test/files/checks/SQLInjection.java"), new VisitorsBridge(check, ImmutableList.of(new File("target/test-classes"))));
    CheckMessagesVerifier.verify(file.getCheckMessages())
        .next().atLine(14).withMessage("\"param\" is provided externally to the method and not sanitized before use.")
        .next().atLine(16)
        .next().atLine(30)
        .next().atLine(31)
        .next().atLine(32)
        .next().atLine(37)
        .next().atLine(38).withMessage("\"param2\" is provided externally to the method and not sanitized before use.")
        .next().atLine(39)
        .next().atLine(66)
        .next().atLine(67)
        .noMore();
  }

