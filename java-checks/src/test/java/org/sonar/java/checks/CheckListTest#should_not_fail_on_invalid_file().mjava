  /**
   * Ensures that all checks are able to deal with unparsable files
   */
  @Test
  public void should_not_fail_on_invalid_file() throws Exception {
    SensorContextTester context = SensorContextTester.create(new File("")).setRuntime(SonarRuntimeImpl.forSonarQube(Version.create(6, 7), SonarQubeSide.SCANNER));
    DefaultInputFile resource = new TestInputFileBuilder("", "src/test/files/CheckListParseErrorTest.java").setCharset(StandardCharsets.UTF_8).build();
    context.fileSystem().add(resource);
    SonarComponents sonarComponents = new SonarComponents(null, context.fileSystem(), null, null, null);
    sonarComponents.setSensorContext(context);
    for (Class check : CheckList.getChecks()) {
      CodeVisitor visitor = (CodeVisitor) check.newInstance();
      if (visitor instanceof JavaFileScanner) {
        JavaAstScanner.scanSingleFileForTests(new File("src/test/files/CheckListParseErrorTest.java"), new VisitorsBridgeForTests((JavaFileScanner) visitor, sonarComponents));
      }
    }
  }

