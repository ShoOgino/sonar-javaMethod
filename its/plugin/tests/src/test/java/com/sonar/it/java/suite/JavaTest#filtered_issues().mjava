  /**
   * SONARJAVA-1615
   */
  @Test
  public void filtered_issues() throws Exception {
    MavenBuild build = MavenBuild.create(TestUtils.projectPom("filtered-issues"))
      .setCleanPackageSonarGoals()
      .setProperty("sonar.profile", "filtered-issues")
      .setProperty("sonar.dynamicAnalysis", "false");
    orchestrator.executeBuild(build);

    assertThat(getMeasure("org.example:example", "violations").getValue()).isEqualTo(2);

    IssueClient issueClient = orchestrator.getServer().wsClient().issueClient();
    List<Issue> issues = issueClient.find(IssueQuery.create().components("org.example:example:src/main/java/EclispeI18NFiltered.java")).list();
    assertThat(issues).hasSize(2);
    for (Issue issue : issues) {
      assertThat(issue.ruleKey()).satisfies(new Condition<String>() {
        @Override
        public boolean matches(String value) {
          return "squid:S1444".equals(value) || "squid:ClassVariableVisibilityCheck".equals(value);
        }
      });
      assertThat(issue.line()).isEqualTo(17);
    }
  }

