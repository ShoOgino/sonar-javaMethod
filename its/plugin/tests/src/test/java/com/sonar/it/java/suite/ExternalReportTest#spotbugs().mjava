  @Test
  public void spotbugs() {
    MavenBuild build = MavenBuild.create(TestUtils.projectPom("spotbugs-external-report"))
      .setProperty("sonar.java.spotbugs.reportPaths", "target" + File.separator + "spotbugsXml.xml")
      .setGoals("clean package com.github.spotbugs:spotbugs-maven-plugin:3.1.12:spotbugs", "sonar:sonar");
    orchestrator.executeBuild(build);

    String projectKey = "org.sonarsource.it.projects:spotbugs-external-report";
    List<Issue> issues = getExternalIssues(projectKey);
    boolean externalIssuesSupported = orchestrator.getServer().version().isGreaterThanOrEquals(7, 2);
    if (externalIssuesSupported) {
      assertThat(issues).hasSize(1);
      Issue issue = issues.get(0);
      assertThat(issue.getComponent()).isEqualTo(projectKey + ":src/main/java/org/myapp/Main.java");
      assertThat(issue.getRule()).isEqualTo("external_spotbugs:HE_EQUALS_USE_HASHCODE");
      assertThat(issue.getLine()).isEqualTo(6);
      assertThat(issue.getMessage()).isEqualTo("org.myapp.Main defines equals and uses Object.hashCode()");
      assertThat(issue.getSeverity()).isEqualTo(Severity.MAJOR);
      assertThat(issue.getDebt()).isEqualTo("5min");
    } else {
      assertThat(issues).isEmpty();
    }
  }

