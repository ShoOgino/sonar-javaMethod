  @Test
  public void should_detect_missing_package_info() throws Exception {
    List<Issue> issues = TestUtils.issuesForComponent(orchestrator, "org.sonarsource.it.projects:package-info");

    assertThat(issues).hasSize(2);
    assertThat(issues.stream().map(Issue::getRule)).allMatch("java:S1228"::equals);
    assertThat(issues.stream().map(Issue::getLine)).allMatch(line -> line == 0);
    Pattern packagePattern = Pattern.compile("'org\\.package[12]'");
    assertThat(issues.stream().map(Issue::getMessage)).allMatch(msg -> packagePattern.matcher(msg).find());

    List<Issue> issuesOnTestPackage = TestUtils.issuesForComponent(orchestrator, "org.sonarsource.it.projects:package-info:src/test/java/package1");
    assertThat(issuesOnTestPackage).isEmpty();
  }

