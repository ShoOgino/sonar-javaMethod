  public static RegexParseResult parseRegex(String regex, boolean freeSpacingMode) {
    int initialFlags = freeSpacingMode ? Pattern.COMMENTS : 0;
    RegexSource source = makeSource(regex);
    RegexParseResult result = new RegexParser(source, new FlagSet(initialFlags)).parse();
    assertEquals(initialFlags, result.getInitialFlags().getMask(), "The initial flags in result should match those passed in.");
    return result;
  }

