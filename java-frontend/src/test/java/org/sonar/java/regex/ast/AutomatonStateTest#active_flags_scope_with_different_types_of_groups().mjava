  @Test
  void active_flags_scope_with_different_types_of_groups() {
    String regex = "(?i)a(?:(?u)b)|[c](?>(?-i)d)(?u)e(?=(?-U)f)g(?U)h(?-u)i";
    assertThat(allStates(assertSuccessfulParseResult(regex)).stream()
      .map(AutomatonStateTest::printClassAndFlags)
      .collect(Collectors.joining("\n")))
        .isEqualTo("" +
          "StartState\n" +
          "DisjunctionTree\n" +
          "SequenceTree\n" +
          "NonCapturingGroupTree<flags: i:3>\n" +
          "CharacterTree 'a' <flags: i:3>\n" +
          "NonCapturingGroupTree<flags: i:3>\n" +
          "SequenceTree<flags: i:3>\n" +
          "NonCapturingGroupTree<flags: i:3 u:11>\n" +
          "CharacterTree 'b' <flags: i:3 u:11>\n" +
          "FinalState<flags: i:3 U:47>\n" +
          "SequenceTree<flags: i:3>\n" +
          "CharacterClassTree<flags: i:3>\n" +
          "AtomicGroupTree<flags: i:3>\n" +
          "SequenceTree<flags: i:3>\n" +
          "NonCapturingGroupTree\n" +
          "CharacterTree 'd' \n" +
          "NonCapturingGroupTree<flags: i:3 u:31>\n" +
          "CharacterTree 'e' <flags: i:3 u:31>\n" +
          "LookAroundTree<flags: i:3 u:31>\n" +
          "SequenceTree<flags: i:3 u:31>\n" +
          "NonCapturingGroupTree<flags: i:3>\n" +
          "CharacterTree 'f' <flags: i:3>\n" +
          "EndOfLookaroundState<flags: i:3 u:31>\n" +
          "CharacterTree 'g' <flags: i:3 u:31>\n" +
          "NonCapturingGroupTree<flags: i:3 u:31 U:47>\n" +
          "CharacterTree 'h' <flags: i:3 u:31 U:47>\n" +
          "NonCapturingGroupTree<flags: i:3 U:47>\n" +
          "CharacterTree 'i' <flags: i:3 U:47>");
  }

