  @Test
  void testNegativeLookAhead() {
    RegexTree regex = assertSuccessfulParse("(?!x)");
    LookAroundTree lookAround = assertType(LookAroundTree.class, regex);
    assertKind(RegexTree.Kind.LOOK_AROUND, lookAround);
    assertEquals(LookAroundTree.Polarity.NEGATIVE, lookAround.getPolarity());
    assertEquals(LookAroundTree.Direction.AHEAD, lookAround.getDirection());
    assertNotNull(lookAround.getElement());
    RegexTree x = lookAround.getElement();
    assertCharacter('x', x);

    FinalState finalState = assertType(FinalState.class, regex.continuation());
    assertEquals(AutomatonState.TransitionType.EPSILON, lookAround.incomingTransitionType());
    assertListSize(2, lookAround.successors());
    NegationState negationState = assertType(NegationState.class, lookAround.successors().get(0));
    assertListElements(lookAround.successors(),
      assertEdge(negationState, AutomatonState.TransitionType.NEGATION),
      assertEdge(finalState, AutomatonState.TransitionType.EPSILON)
    );
    assertSingleEdge(negationState, x, AutomatonState.TransitionType.CHARACTER);
    EndOfLookaroundState endOfLookaroundState = assertType(EndOfLookaroundState.class, x.continuation());
    assertSingleEdge(x, endOfLookaroundState, AutomatonState.TransitionType.LOOKAROUND_BACKTRACKING);
    assertSingleEdge(endOfLookaroundState, finalState, AutomatonState.TransitionType.EPSILON);
  }

