  @Test
  void active_flags_scope() {
    String regex = "(?i)a(?u:b)|[c](?-i:d)(?u)e((?-U)f)g(?U)h(?-u)i";
    assertThat(allStates(assertSuccessfulParseResult(regex)).stream()
      .map(AutomatonStateTest::printClassAndFlags)
      .collect(Collectors.joining("\n")))
        .isEqualTo("" +
          "StartState\n" +
          "DisjunctionTree\n" +
          "SequenceTree\n" +
          "NonCapturingGroupTree<flags: i:3>\n" +
          "CharacterTree 'a' <flags: i:3>\n" +
          "NonCapturingGroupTree<flags: i:3 u:8>\n" +
          "CharacterTree 'b' <flags: i:3 u:8>\n" +
          "FinalState<flags: i:3 U:39>\n" +
          "SequenceTree<flags: i:3>\n" +
          "CharacterClassTree<flags: i:3>\n" +
          "NonCapturingGroupTree\n" +
          "CharacterTree 'd' \n" +
          "NonCapturingGroupTree<flags: i:3 u:25>\n" +
          "CharacterTree 'e' <flags: i:3 u:25>\n" +
          "CapturingGroupTree<flags: i:3 u:25>\n" +
          "SequenceTree<flags: i:3 u:25>\n" +
          "NonCapturingGroupTree<flags: i:3>\n" +
          "CharacterTree 'f' <flags: i:3>\n" +
          "EndOfCapturingGroupState<flags: i:3 u:25>\n" +
          "CharacterTree 'g' <flags: i:3 u:25>\n" +
          "NonCapturingGroupTree<flags: i:3 u:25 U:39>\n" +
          "CharacterTree 'h' <flags: i:3 u:25 U:39>\n" +
          "NonCapturingGroupTree<flags: i:3 U:39>\n" +
          "CharacterTree 'i' <flags: i:3 U:39>");
  }

