  @Test
  public void feedback_should_not_be_sent_in_sonarLintContext_or_when_collecting_is_disabled_or_when_no_errors() {
    File file = new File("src/test/files/ParseError.java");
    SensorContextTester sensorContext = SensorContextTester.create(file.getParentFile().getAbsoluteFile());
    Measure<String> feedback = analysisWithAnError(sensorContext);
    assertThat(feedback).isNull();

    sensorContext = SensorContextTester.create(file.getParentFile().getAbsoluteFile());
    sensorContext.setSettings(new MapSettings().setProperty(SonarComponents.COLLECT_ANALYSIS_ERRORS_KEY, true));
    sensorContext.setRuntime(SonarRuntimeImpl.forSonarLint(Version.create(6, 7)));
    feedback = analysisWithAnError(sensorContext);
    assertThat(feedback).isNull();

    //analysis with no error
    sensorContext = SensorContextTester.create(file.getParentFile().getAbsoluteFile());
    SonarComponents sonarComponents = new SonarComponents(null, null, null, null, null);
    sonarComponents.setSensorContext(sensorContext);
    sonarComponents.saveAnalysisErrors();
    assertThat(sensorContext.measure("projectKey", "sonarjava_feedback")).isNull();

  }

