  @Test
  public void sonarcloud_feedback_metric_should_not_exceed_roughly_200ko() {
    File file = new File("src/test/files/ParseError.java");
    SensorContextTester sensorContext = SensorContextTester.create(file.getParentFile().getAbsoluteFile());
    sensorContext.setSettings(new MapSettings().setProperty(SonarComponents.COLLECT_ANALYSIS_ERRORS_KEY, true));
    Measure<String> feedback = analysisWithAnError(sensorContext);
    Collection<AnalysisError> analysisErrorsDeserialized = new Gson().fromJson(feedback.value(), new TypeToken<Collection<AnalysisError>>(){}.getType());
    // because we are storing stracktrace of the exception, number of exceptions we manage to serialize into given size can vary
    assertThat(analysisErrorsDeserialized.size()).isBetween(30, 45);
    assertThat(analysisErrorsDeserialized.iterator().next().getKind()).isEqualTo(AnalysisError.Kind.PARSE_ERROR);
  }

