  @Test
  public void MethodReferenceUsingThis() throws Exception {
    Result result = Result.createFor("MethodReferencesThis");

    JavaSymbol bar1 = result.symbol("bar1");
    assertThat(bar1.usages()).hasSize(2);

    JavaSymbol bar = result.symbol("bar");
    assertThat(bar.usages()).hasSize(1);

    MethodReferenceTree methodRef = (MethodReferenceTree) bar.usages().get(0).parent();
    assertThat(methodRef.symbolType().is("java.util.function.Consumer")).isTrue();

    MethodInvocationTree foreach = (MethodInvocationTree) methodRef.parent().parent();
    assertThat(foreach.symbol().owner().type().is("java.lang.Iterable")).isTrue();
  }

