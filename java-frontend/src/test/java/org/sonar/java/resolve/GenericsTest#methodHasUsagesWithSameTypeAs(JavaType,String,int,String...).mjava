  private static void methodHasUsagesWithSameTypeAs(JavaType type, String methodName, int methodIndex, String... variables) {
    JavaSymbol.MethodJavaSymbol method = getMethodSymbol(type, methodName, methodIndex);

    List<IdentifierTree> usages = method.usages();
    assertThat(usages).overridingErrorMessage("Method '" + methodName + "' should have " + variables.length + " reference(s) but has " + usages.size() + ".")
      .hasSize(variables.length);

    for (int i = 0; i < variables.length; i++) {
      String variableName = variables[i];
      if (variableName != null) {
        Type methodInvocationType = getMethodInvocationType(method, i);
        Type variableType = getVariableType(type, variableName);
        assertThat(methodInvocationType).overridingErrorMessage("Type of expression should be the same as type of variable '" + variableName + "'.").isSameAs(variableType);
      }
    }
  }

