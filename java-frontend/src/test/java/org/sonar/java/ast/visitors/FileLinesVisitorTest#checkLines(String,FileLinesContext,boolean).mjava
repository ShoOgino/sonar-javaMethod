  private void checkLines(String filename, FileLinesContext context, boolean sqGreaterThan62) {
    SonarComponents sonarComponents = mock(SonarComponents.class);
    when(sonarComponents.fileLength(Mockito.any(File.class))).thenAnswer(invocation -> {
      File arg = (File) invocation.getArguments()[0];
      return Files.readLines(arg, StandardCharsets.UTF_8).size();
    });
    when(sonarComponents.isSQGreaterThan62()).thenReturn(sqGreaterThan62);
    when(sonarComponents.fileLinesContextFor(Mockito.any(File.class))).thenReturn(context);

    JavaSquid squid = new JavaSquid(conf, null, null, null, null, new FileLinesVisitor(sonarComponents));
    squid.scan(Lists.newArrayList(new File(baseDir, filename)), Collections.emptyList());
  }

