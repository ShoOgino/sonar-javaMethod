  @Test
  public void equality() {
    Object a = new Object();
    Object b = new Object();
    Object c = new Object();

    PStack<Object> s1 = PCollections.emptyStack().push(b).push(a);
    PStack<Object> s2 = PCollections.emptyStack().push(b).push(a);
    assertThat(s1.equals(s2)).isTrue();

    // twice to cover hashCode cache
    assertThat(s1.hashCode() == s2.hashCode()).isTrue();
    assertThat(s1.hashCode() == s2.hashCode()).isTrue();

    assertThat(s1).isNotEqualTo(null);
    assertThat(s1).isEqualTo(s1);

    s1 = PCollections.emptyStack().push(b).push(a);
    s2 = PCollections.emptyStack().push(c).push(a);
    assertThat(s1.equals(s2)).isFalse();
  }

