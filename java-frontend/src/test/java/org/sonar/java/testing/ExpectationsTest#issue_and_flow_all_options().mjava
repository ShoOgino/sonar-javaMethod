  @Test
  public void issue_and_flow_all_options() {
    Expectations.Parser.ParsedComment iaf = new Expectations().parser()
      .parseIssue("// Noncompliant [[flows;sc=1;ec=2]] bla {{issue msg}} bla flow@id [[sc=3;ec=4]] bla {{flow msg}} bla", LINE);
    assertThat(iaf.issue).isEqualTo(ImmutableMap.of(
      Expectations.IssueAttribute.LINE, 42,
      MESSAGE, "issue msg",
      START_COLUMN, 1,
      END_COLUMN, 2,
      FLOWS, Collections.emptyList()
    ));
    assertThat(iaf.flows).hasSize(1);
    Expectations.FlowComment flow = iaf.flows.iterator().next();
    assertThat(flow.line).isEqualTo(LINE);
    assertThat(flow.attributes).isEqualTo(ImmutableMap.of(
      MESSAGE, "flow msg",
      START_COLUMN, 3,
      END_COLUMN, 4
    ));
  }

