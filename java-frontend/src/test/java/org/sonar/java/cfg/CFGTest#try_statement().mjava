  @Test
  public void try_statement() {
    CFG cfg = buildCFG("void fun() {try {System.out.println('');} finally { System.out.println(''); }}");
    CFGChecker cfgChecker = checker(
        block(
            element(Tree.Kind.TRY_STATEMENT)
        ).successors(1, 2).exit(1),
        block(
            element(Tree.Kind.CHAR_LITERAL, "''"),
            element(Tree.Kind.IDENTIFIER, "System"),
            element(Tree.Kind.MEMBER_SELECT),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(1),
        block(
            element(Tree.Kind.CHAR_LITERAL, "''"),
            element(Tree.Kind.IDENTIFIER, "System"),
            element(Tree.Kind.MEMBER_SELECT),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(0));
    cfgChecker.check(cfg);
    cfg = buildCFG("void fun() {try {System.out.println('');} catch(IllegalArgumentException e) { foo('iae');} catch(Exception e){foo('e');}" +
        " finally { System.out.println('finally'); }}");
    cfgChecker = checker(
        block(
            element(Tree.Kind.TRY_STATEMENT)
        ).successors(2, 3, 4),
        block(
            element(Tree.Kind.CHAR_LITERAL, "'e'"),
            element(Tree.Kind.IDENTIFIER, "foo"),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(1),
        block(
            element(Tree.Kind.CHAR_LITERAL, "'iae'"),
            element(Tree.Kind.IDENTIFIER, "foo"),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(1),
        block(
            element(Tree.Kind.CHAR_LITERAL, "''"),
            element(Tree.Kind.IDENTIFIER, "System"),
            element(Tree.Kind.MEMBER_SELECT),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(1, 3, 4),
        block(
            element(Tree.Kind.CHAR_LITERAL, "'finally'"),
            element(Tree.Kind.IDENTIFIER, "System"),
            element(Tree.Kind.MEMBER_SELECT),
            element(Tree.Kind.METHOD_INVOCATION)
        ).successors(0)
    );
    cfgChecker.check(cfg);
    cfg = buildCFG(
        "  private void f() {\n" +
            "    try {\n" +
            "    } catch (Exception e) {\n" +
            "      if (e instanceof IOException) { \n" +
            "      }\n}}");
    cfgChecker = checker(
        block(
            element(Tree.Kind.TRY_STATEMENT)
        ).successors(1, 2),
        block(
            element(Tree.Kind.IDENTIFIER, "e"),
            element(Tree.Kind.INSTANCE_OF)
        ).terminator(Tree.Kind.IF_STATEMENT).ifTrue(0).ifFalse(0),
        new BlockChecker(0, 2) // particular case of a block with multiple successors but no instructions.
    );
    cfgChecker.check(cfg);
    cfg = buildCFG(
        "  private void f() {\n" +
            "    try {\n" +
            "    return;" +
            "} finally { foo();} bar(); }");
    cfgChecker = checker(
        block(
            element(Tree.Kind.TRY_STATEMENT)
        ).successors(2, 3).exit(2),
        terminator(Kind.RETURN_STATEMENT).successors(2).exit(2),
        block(
            element(Tree.Kind.IDENTIFIER, "foo"),
            element(Kind.METHOD_INVOCATION)
        ).successors(0, 1).exit(0),
        block(
            element(Tree.Kind.IDENTIFIER, "bar"),
            element(Kind.METHOD_INVOCATION)
        ).successors(0)
    );
    cfgChecker.check(cfg);
  }

