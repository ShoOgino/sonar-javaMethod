  private void validateFlowMessages(List<AnalyzerMessage> actual, String flowId, Collection<Expectations.FlowComment> expected) {
    ListMultimap<Integer, String> actualMessages = ArrayListMultimap.create();
    actual.forEach(m -> actualMessages.put(m.getLine(), m.getMessage()));

    ListMultimap<Integer, String> expectedMessages = ArrayListMultimap.create();
    expected.stream()
      .filter(f -> f.get(MESSAGE) != null)
      .forEach(f -> expectedMessages.put(f.line, f.get(MESSAGE)));

    Multimap<Integer, String> missing = Multimaps.filterEntries(expectedMessages, e -> !actualMessages.containsEntry(e.getKey(), e.getValue()));
    assertThat(missing.asMap())
      .overridingErrorMessage("Wrong messages in flow %s\n expected: %s\n actual: %s", flowId, expectedMessages, actualMessages)
      .isEmpty();
  }

