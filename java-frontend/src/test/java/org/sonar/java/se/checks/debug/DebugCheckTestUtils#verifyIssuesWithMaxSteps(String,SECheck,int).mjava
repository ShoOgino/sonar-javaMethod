  static void verifyIssuesWithMaxSteps(String sourcefile, SECheck check, int maxSteps) {
    BehaviorCache behaviorCache = new BehaviorCache();
    SymbolicExecutionVisitor sev = new SymbolicExecutionVisitor(Collections.singletonList(check), behaviorCache) {
      @Override
      protected ExplodedGraphWalker getWalker() {
        return new ExplodedGraphWalker(Collections.singletonList(check), behaviorCache, (Sema) context.getSemanticModel()) {
          @Override
          protected int maxSteps() {
            return maxSteps;
          }
        };
      }

      @Override
      public void scanFile(JavaFileScannerContext context) {
        super.scanFile(context);
        // the check has been executed, but we still need to call the scan manually to report the issues
        check.scanFile(context);
      }
    };
    CheckVerifier.newVerifier()
      .onFile(sourcefile)
      .withCheck(sev)
      .withClassPath(SETestUtils.CLASS_PATH)
      .verifyIssues();
  }

