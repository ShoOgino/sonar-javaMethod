  @Test
  public void cancellation() {
    SonarComponents sonarComponents = new SonarComponents(null, null, null, null, null, null);
    SensorContextTester context = SensorContextTester.create(new File(""));
    sonarComponents.setSensorContext(context);

    context.setRuntime(SonarRuntimeImpl.forSonarLint(V5_6));
    assertThat(sonarComponents.analysisCancelled()).isFalse();

    context.setRuntime(SonarRuntimeImpl.forSonarLint(V6_0));
    assertThat(sonarComponents.analysisCancelled()).isFalse();

    // cancellation only handled from SQ 6.0
    context.setCancelled(true);

    context.setRuntime(SonarRuntimeImpl.forSonarLint(V5_6));
    assertThat(sonarComponents.analysisCancelled()).isFalse();

    context.setRuntime(SonarRuntimeImpl.forSonarLint(V6_0));
    assertThat(sonarComponents.analysisCancelled()).isTrue();
  }

