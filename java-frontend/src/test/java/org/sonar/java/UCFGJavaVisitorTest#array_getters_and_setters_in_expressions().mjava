  @Test
  public void array_getters_and_setters_in_expressions() {
    Expression.Variable foo = variableWithId("foo");
    Expression.Variable array = variableWithId("array");
    Expression.Variable intA = variableWithId("intA");
    Expression.Variable aux0 = variableWithId("%0");
    Expression.Variable aux1 = variableWithId("%1");
    Expression.Variable aux2 = variableWithId("%2");
    Expression.Variable aux3 = variableWithId("%3");
    Expression.Variable aux4 = variableWithId("%4");
    Expression.Variable aux5 = variableWithId("%5");
    Expression.Variable aux6 = variableWithId("%6");
    Expression.Variable aux7 = variableWithId("%7");
    Expression.Variable aux8 = variableWithId("%8");
    Expression.Variable s = variableWithId("s");
    String methodId = "A#foo(Ljava/lang/String;[Ljava/lang/String;[I)Ljava/lang/String;";
    UCFG expectedUCFG = UCFGBuilder.createUCFGForMethod(methodId)
        .addBasicBlock(newBasicBlock("1")
            .assignTo(aux0, call("__arrayGet").withArgs(intA), new LocationInFile(FILE_KEY, 3,14,3,21))
            .assignTo(aux1, call("__arrayGet").withArgs(array), new LocationInFile(FILE_KEY, 3,8,3,22))
            .assignTo(aux2, call(methodId).withArgs(Expression.THIS, aux1, array, intA), new LocationInFile(FILE_KEY, 3,4,3,36))
            .assignTo(aux3, call("__arrayGet").withArgs(array), new LocationInFile(FILE_KEY, 4,4,4,12))
            .assignTo(aux4, call("__concat").withArgs(aux3, foo), new LocationInFile(FILE_KEY, 4,4,4,19))
            .assignTo(aux5, call("__arraySet").withArgs(array, aux4), new LocationInFile(FILE_KEY, 4,4,4,19))
            .assignTo(aux6, call("__arrayGet").withArgs(array), new LocationInFile(FILE_KEY, 5,15,5,23))
            .assignTo(s, call("__id").withArgs(aux6), new LocationInFile(FILE_KEY, 5,4,5,24))
            .assignTo(aux7, call("__arrayGet").withArgs(array), new LocationInFile(FILE_KEY, 6,11,6,19))
            .assignTo(aux8, call("__concat").withArgs(aux7, s), new LocationInFile(FILE_KEY, 6,11,6,23))
            .ret(aux8, new LocationInFile(FILE_KEY, 6, 4, 6, 24)))
        .build();
    assertCodeToUCfg("class A { \n" +
        "  private String foo(String foo, String[] array, int[] intA) { \n" +
        "    foo(array[intA[0]], array, intA);\n" +
        "    array[0] += foo;\n" +
        "    String s = array[1];\n" +
        "    return array[0] + s;\n" +
        "  }\n" +
        "}", expectedUCFG);
  }

