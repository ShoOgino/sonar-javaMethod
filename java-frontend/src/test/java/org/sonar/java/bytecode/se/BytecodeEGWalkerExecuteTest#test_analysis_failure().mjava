  @Test
  public void test_analysis_failure() throws Exception {
    initializeWalker();
    BytecodeEGWalker walkerSpy = spy(walker);
    IllegalStateException ex = new IllegalStateException();
    doThrow(ex).when(walkerSpy).executeInstruction(any());

    assertThatThrownBy(() -> walkerSpy.getMethodBehavior("java.lang.String#length()I", null, squidClassLoader))
      .isInstanceOf(BytecodeEGWalker.BytecodeAnalysisException.class)
      .hasMessage("Failed dataflow analysis for java.lang.String#length()I")
      .hasCause(ex);
  }

