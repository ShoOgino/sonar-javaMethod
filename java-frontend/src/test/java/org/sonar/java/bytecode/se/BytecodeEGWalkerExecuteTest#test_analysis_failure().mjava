  @Test
  public void test_analysis_failure() throws Exception {
    BytecodeEGWalker walkerSpy = spy(walker);
    IllegalStateException ex = new IllegalStateException();
    doThrow(ex).when(walkerSpy).executeInstruction(any());

    assertThatThrownBy(() -> walkerSpy.getMethodBehavior("java.lang.String#valueOf(Z)Ljava/lang/String;", squidClassLoader))
      .isInstanceOf(BytecodeEGWalker.BytecodeAnalysisException.class)
      .hasMessage("Failed dataflow analysis for java.lang.String#valueOf(Z)Ljava/lang/String;")
      .hasCause(ex);
  }

