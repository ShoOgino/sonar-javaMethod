  @Test
  public void should_report_issue_on_lines_of_all_locations() {
    ArrayList<Location> secondaries = new ArrayList<>();

    // secondary on located tree
    int secondary1Line = 1;
    int secondary1Column = 3;
    int secondary1Size = 5;
    String msg1 = "msg1";
    secondaries.add(new Location(msg1, fakeLocatedTree(secondary1Line, secondary1Column, secondary1Size)));

    // secondary on located tree with unknown column - will use the complete line
    int secondary2Line = 2;
    String msg2 = "msg2";
    secondaries.add(new Location(msg2, fakeLocatedTreeWithUnknownColumn(secondary2Line)));

    // secondary on a given line with unknown column
    int secondary3Line = 3;
    String msg3 = "msg3";
    secondaries.add(new Location(msg3, secondary3Line));

    String msg = "message";
    context.reportIssue(CHECK, LINE, msg, secondaries);

    String expected = "analyzerMessage:" + msg;
    expected += ";" + msg1 + "[" + secondary1Line + ";" + (secondary1Column - 1) + "/" + secondary1Line + ";" + (secondary1Column + secondary1Size - 1) + "]";
    expected += ";" + msg2 + "[" + secondary2Line + ";0/" + secondary2Line + ";6]";
    expected += ";" + msg3 + "[" + secondary3Line + ";0/" + secondary3Line + ";16]";

    assertThat(reportedMessage).isEqualTo(expected);
  }

