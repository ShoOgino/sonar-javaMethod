  private boolean needsClosing(Type type) {
    if (type.isSubtypeOf(STREAM_TOP_HIERARCHY)) {
      return false;
    }
    for (String ignoredTypes : IGNORED_CLOSEABLE_SUBTYPES) {
      if (type.isSubtypeOf(ignoredTypes)) {
        return false;
      }
    }
    for (String excludedType : loadExcludedTypesList()) {
      if (type.is(excludedType)) {
        return false;
      }
    }
    return isCloseable(type);
  }

