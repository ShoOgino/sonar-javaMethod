  public static List<JavaFileScannerContext.Location> flow(
    ExplodedGraph.Node currentNode, SymbolicValue currentVal, Predicate<Constraint> addToFlow, Predicate<Constraint> terminateTraversal) {
    List<JavaFileScannerContext.Location> flow = new ArrayList<>();
    if (currentVal instanceof BinarySymbolicValue) {
      Set<JavaFileScannerContext.Location> locations = new HashSet<>();
      locations.addAll(SECheck.flow(currentNode.parent(), ((BinarySymbolicValue) currentVal).getLeftOp(), addToFlow, terminateTraversal));
      locations.addAll(SECheck.flow(currentNode.parent(), ((BinarySymbolicValue) currentVal).getRightOp(), addToFlow, terminateTraversal));
      flow.addAll(locations);
    }
    ExplodedGraph.Node node = currentNode;
    Symbol lastEvaluated = currentNode.programState.getLastEvaluated();
    while (node != null) {
      ExplodedGraph.Node finalNode = node;
      node = node.parent();
      if (finalNode.programPoint.syntaxTree() == null) {
        continue;
      }

      List<Constraint> learnedConstraints = finalNode.getLearnedConstraints().stream()
        .filter(lc -> lc.getSv().equals(currentVal))
        .map(ExplodedGraph.Node.LearnedConstraint::getConstraint)
        .collect(Collectors.toList());

      if (learnedConstraints.stream().anyMatch(addToFlow)) {
        flow.add(new JavaFileScannerContext.Location("...", finalNode.parent().programPoint.syntaxTree()));
      }
      if (learnedConstraints.stream().anyMatch(terminateTraversal)) {
        break;
      }

      if (lastEvaluated != null) {
        Symbol finalLastEvaluated = lastEvaluated;
        Optional<Symbol> learnedSymbol = finalNode.getLearnedSymbols().stream()
          .map(ExplodedGraph.Node.LearnedValue::getSymbol)
          .filter(sv -> sv.equals(finalLastEvaluated))
          .findFirst();
        if (learnedSymbol.isPresent()) {
          lastEvaluated = finalNode.parent().programState.getLastEvaluated();
          flow.add(new JavaFileScannerContext.Location("...", finalNode.parent().programPoint.syntaxTree()));
        }
      }
    }
    return flow;
  }

