  public static void saveIssue(SensorContext context, ExternalRuleLoader ruleLoader, InputFile inputFile, RuleKey ruleKey, String line, String message) {
    NewExternalIssue newExternalIssue = context.newExternalIssue();

    newExternalIssue
      .type(ruleLoader.ruleType(ruleKey.rule()))
      .severity(ruleLoader.ruleSeverity(ruleKey.rule()))
      .remediationEffortMinutes(ruleLoader.ruleConstantDebtMinutes(ruleKey.rule()));

    NewIssueLocation primaryLocation = newExternalIssue.newLocation()
      .message(message)
      .on(inputFile);

    if (!line.isEmpty() && !line.equals("0")) {
      primaryLocation.at(inputFile.selectLine(Integer.parseInt(line)));
    }

    newExternalIssue
      .at(primaryLocation)
      .forRule(ruleKey)
      .save();
  }

