  @Override
  public void visitCompilationUnit(CompilationUnitTree tree) {
    if (!tree.types().isEmpty()) {
      scan(Iterables.getLast(tree.types()));
    } else if (!tree.imports().isEmpty()) {
      scan(Iterables.getLast(tree.imports()));
    } else {
      // TODO(SONARJAVA-547) Should be the semi-colon token
      scan(tree.packageName());
    }
    // with empty files lastSyntaxToken will be null
  }

