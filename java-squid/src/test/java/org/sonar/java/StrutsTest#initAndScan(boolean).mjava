  private void initAndScan(boolean separateAccessorsFromMethods) {
    File prjDir = new File("target/test-projects/struts-core-1.3.9");
    File srcDir = new File(prjDir, "src");
    File binDir = new File(prjDir, "bin");

    JavaConfiguration conf = new JavaConfiguration(Charsets.UTF_8);
    conf.setSeparateAccessorsFromMethods(separateAccessorsFromMethods);
    context = mock(SensorContext.class);
    when(context.getResource(any(InputPath.class))).thenReturn(mock(Resource.class));
    DefaultFileSystem fs = new DefaultFileSystem(prjDir);
    Collection<File> files = FileUtils.listFiles(srcDir, new String[]{"java"}, true);
    for (File file : files) {
      fs.add(new DefaultInputFile(file.getPath()));
    }
    Measurer measurer = new Measurer(fs, context, separateAccessorsFromMethods, mock(NoSonarFilter.class));
    JavaResourceLocator javaResourceLocator = mock(JavaResourceLocator.class);
    JavaSquid squid = new JavaSquid(conf, null, measurer, javaResourceLocator, new CodeVisitor[0]);
    squid.scan(files, Collections.<File>emptyList(), Collections.singleton(binDir));
  }

