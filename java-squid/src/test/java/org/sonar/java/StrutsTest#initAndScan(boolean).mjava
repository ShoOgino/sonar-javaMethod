  private void initAndScan(boolean separateAccessorsFromMethods) {
    File prjDir = new File("target/test-projects/struts-core-1.3.9");
    File srcDir = new File(prjDir, "src");
    File binDir = new File(prjDir, "bin");

    JavaConfiguration conf = new JavaConfiguration(Charsets.UTF_8);
    conf.setSeparateAccessorsFromMethods(separateAccessorsFromMethods);
    context = mock(SensorContext.class);
    Project sonarProject = mock(Project.class);
    ProjectFileSystem pfs = mock(ProjectFileSystem.class);
    when(pfs.getBasedir()).thenReturn(prjDir);
    when(sonarProject.getFileSystem()).thenReturn(pfs);
    Measurer measurer = new Measurer(sonarProject, context, separateAccessorsFromMethods);
    JavaSquid squid = new JavaSquid(conf, null, measurer, mock(JavaResourceLocator.class), new CodeVisitor[0]);
    Collection<File> files = FileUtils.listFiles(srcDir, new String[]{"java"}, true);
    squid.scan(files, Collections.<File>emptyList(), Collections.singleton(binDir));
  }

