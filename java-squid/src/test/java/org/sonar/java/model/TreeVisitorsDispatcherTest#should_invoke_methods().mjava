  @Test
  public void should_invoke_methods() {
    EmptyStatementTree emptyStatement = new JavaTree.EmptyStatementTreeImpl(Mockito.mock(AstNode.class));
    IfStatementTree ifStatement = new JavaTree.IfStatementTreeImpl(Mockito.mock(AstNode.class),
      new JavaTree.IdentifierTreeImpl(Mockito.mock(AstNode.class), "i"),
      emptyStatement,
      null
    );

    FakeVisitor visitor1 = Mockito.mock(FakeVisitor.class);
    FakeVisitor visitor2 = Mockito.mock(FakeVisitor.class);
    TreeVisitorsDispatcher dispatcher = new TreeVisitorsDispatcher(ImmutableList.of(visitor1, visitor2));
    JavaTree.scan(ifStatement, dispatcher);

    InOrder inOrder = Mockito.inOrder(visitor1, visitor2);
    inOrder.verify(visitor1).visit(ifStatement);
    inOrder.verify(visitor2).visit(ifStatement);
    inOrder.verify(visitor1).visit(emptyStatement);
    inOrder.verify(visitor2).visit(emptyStatement);

    inOrder.verify(visitor2).leave(emptyStatement);
    inOrder.verify(visitor1).leave(emptyStatement);
    inOrder.verify(visitor2).leave(ifStatement);
    inOrder.verify(visitor1).leave(ifStatement);
  }

