  protected void verifyLog(final String expectedFormattedMessage, final Level expectedLevel, VerificationMode mode) {
    verify(mockAppender, mode).doAppend(Matchers.argThat(new ArgumentMatcher() {

      @Override
      public boolean matches(final Object argument) {
        LoggingEvent event = (LoggingEvent) argument;
        return expectedFormattedMessage.equals(event.getFormattedMessage()) &&
          expectedLevel.equals(event.getLevel());
      }

    }));
  }

