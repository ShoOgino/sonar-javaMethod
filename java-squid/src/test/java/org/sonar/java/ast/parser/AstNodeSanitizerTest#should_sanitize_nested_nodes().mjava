  @Test
  public void should_sanitize_nested_nodes() {
    Token token = mock(Token.class);
    when(token.getType()).thenReturn(TOKEN_TYPE);

    AstNode astNode1 = new AstNode(token);
    astNode1.setFromIndex(21);
    astNode1.setToIndex(42);

    AstNode astNode2 = new AstNode(ASTNODE_TYPE, ASTNODE_TYPE.toString(), null);

    AstNode astNode = new AstNode(ASTNODE_TYPE, ASTNODE_TYPE.toString(), null);
    astNode.addChild(astNode1);
    astNode.addChild(astNode2);

    new AstNodeSanitizer().sanitize(astNode);

    assertThat(astNode.getToken()).isSameAs(token);
    assertThat(astNode.getFromIndex()).isEqualTo(21);
    assertThat(astNode.getToIndex()).isEqualTo(42);

    assertThat(astNode2.hasToken()).isFalse();
    assertThat(astNode2.getFromIndex()).isEqualTo(42);
    assertThat(astNode2.getToIndex()).isEqualTo(42);
  }

